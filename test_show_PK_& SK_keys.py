from libs.crypto_utils import CryptoUtils


if __name__ == "__main__":
    crypto = CryptoUtils()
    password="ciao"
    user_id="pippi"
    q = int("4885627005080841389250466027205168044095377653935266400536640927053869381738541280144707731376599082332044772747620552558927044195615453258295448638580979")
    g = int("1969537099834633830988525468395505020930089752175962690324974029844428537628146282127644657629836638860761302226430428871358705166138506673190026928446627")
    p = int("9771254010161682778500932054410336088190755307870532801073281854107738763477082560289415462753198164664089545495241105117854088391230906516590897277161959")
    print(f"Password:{crypto.hash_password(password, user_id)}")
    private_key = (crypto.hash_password(password, user_id) % (q - 1)) + 1
    print(f"[DEBUG_public_key] Private key used: {private_key}")
    print(f"PUBLIC KEY: {pow(g, private_key, p)}")
    